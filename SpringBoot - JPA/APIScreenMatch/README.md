# APIScreenMatch

APIScreenMatch is a Java-based application built with Spring Boot that allows users to search, manage, and explore TV series and their episodes. It integrates with the OMDB API to fetch series data and uses the Google Gemini AI API for translating series descriptions. Data is stored and queried using a PostgreSQL database.

## Features

- Search for TV series and their episodes via the OMDB API.
- Store series and episode data persistently in a PostgreSQL database.
- Translate series synopses into Portuguese using the Google Gemini AI API.
- List all searched series, sortable by genre.
- Query series by:
    - Title
    - Actor(s) and minimum rating
    - Category/Genre
    - Maximum number of seasons and minimum rating
- Retrieve top 5 series based on ratings.
- Search for specific episodes by a partial title match.
- List top 5 episodes for a selected series.
- Find episodes released after a specific year for a selected series.
- Command-line interface for user interaction.

## Technologies Used

- **Java 17**
- **Spring Boot 3.4.4**
- **Spring Data JPA (Hibernate)**
- **PostgreSQL**
- **Maven** (for dependency management)
- **OMDB API** (for series and episode data)
- **Google Gemini AI API** (via `langchain4j-google-ai-gemini:0.35.0` for text translation)
- **Jackson** (`jackson-databind:2.18.3` for JSON processing)
- **Dotenv-java** (`dotenv-java:3.0.0` for environment variable management)

## Prerequisites

- Java 17 or higher installed
- Maven installed
- PostgreSQL database server running
- An OMDB API key
- A Google Gemini API key

## Setup Instructions

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/JoseFabioGuimaraes/APIScreenMatch.git
    cd APIScreenMatch
    ```

2.  **Configure Environment Variables:**
    Create a `.env` file in the root directory of the project with the following content, replacing placeholder values with your actual credentials:
    ```dotenv
    GEMINI_API_KEY=your_google_gemini_api_key
    SPRING_DATASOURCE_HOST=localhost
    SPRING_DATASOURCE_NAME=your_database_name 
    SPRING_DATASOURCE_USERNAME=your_postgres_username
    SPRING_DATASOURCE_PASSWORD=your_postgres_password
    ```
    *   `GEMINI_API_KEY`: Your API key for Google Gemini.
    *   `SPRING_DATASOURCE_HOST`: The host of your PostgreSQL server (e.g., `localhost`).
    *   `SPRING_DATASOURCE_NAME`: The name of your PostgreSQL database (e.g., `screenmatch-alura`).
    *   `SPRING_DATASOURCE_USERNAME`: Your PostgreSQL username.
    *   `SPRING_DATASOURCE_PASSWORD`: Your PostgreSQL password.

3.  **Configure OMDB API Key:**
    The OMDB API key is currently hardcoded in the `src/main/java/br/com/jfabiodev/APIScreenMatch/main/Main.java` file:
    ```java
    private final String API_KEY = "&apikey=f9173cff"; 
    ```
    Replace `"f9173cff"` with your personal OMDB API key. For better practice, consider externalizing this key to the `.env` file and reading it similarly to how `GEMINI_API_KEY` is handled.

4.  **Verify `application.properties`:**
    Ensure `src/main/resources/application.properties` is configured to use these environment variables. The relevant datasource configuration should look like this:
    ```properties
    spring.datasource.url=jdbc:postgresql://${SPRING_DATASOURCE_HOST}/${SPRING_DATASOURCE_NAME}
    spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
    spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
    ```

5.  **Build the project:**
    ```bash
    mvn clean install
    ```

6.  **Run the application:**
    ```bash
    mvn spring-boot:run
    ```
    Alternatively, you can run the application from your IDE (IntelliJ IDEA) by running the `ApiScreenMatchApplication` class.

## API Integration

-   **OMDB API**: Used to fetch detailed information about TV series and their episodes. The API key needs to be configured as mentioned in the Setup Instructions.
-   **Google Gemini AI API**: Used for translating series synopses from English to Portuguese. Requires a `GEMINI_API_KEY` in the `.env` file.

## Database Configuration

The application is configured to use a PostgreSQL database.
-   The connection details are specified in `application.properties` and sourced from environment variables defined in the `.env` file.
-   JPA Hibernate is configured with `spring.jpa.hibernate.ddl-auto = update`, which means Hibernate will attempt to update the database schema based on your entities when the application starts.
-   SQL queries generated by Hibernate can be shown in the console by `spring.jpa.show-sql=true`.

## Project Structure

```
APIScreenMatch/
├── .env                            # Environment variables (you need to create this)
├── pom.xml                         # Maven project configuration
└── src/
└── main/
├── java/
│   └── br/com/jfabiodev/APIScreenMatch/
│       ├── ApiScreenMatchApplication.java  # Spring Boot main application class
│       ├── enums/
│       │   └── Categoria.java            # Enum for series categories
│       ├── main/
│       │   └── Main.java                 # Main CLI interaction logic
│       ├── model/                      # Data Transfer Objects (DTOs) and JPA Entities
│       │   ├── DadosEpisodio.java
│       │   ├── DadosSerie.java
│       │   ├── DadosTemporada.java
│       │   ├── Episodio.java             # JPA Entity for Episode
│       │   └── Serie.java                # JPA Entity for Serie
│       ├── repository/
│       │   └── SerieRepository.java      # Spring Data JPA repository for Serie
│       └── service/
│           ├── ConsultaGemini.java       # Service for Google Gemini API
│           ├── ConsumoAPI.java           # Service for consuming external APIs (OMDB)
│           ├── ConverteDados.java        # Service for JSON data conversion
│           └── IConverteDados.java       # Interface for data conversion
└── resources/
└── application.properties      # Spring Boot application configuration
```

## Usage

1.  Run the application as described in the Setup Instructions.
2.  The application will present a command-line menu with various options.
3.  Enter the number corresponding to the action you wish to perform (e.g., search series, list series, etc.).
4.  Follow the on-screen prompts to provide necessary inputs.
5.  Searched series and their episodes (if fetched) are automatically saved to the PostgreSQL database for future queries.

## AUTOR
```
José Fábio Guimarães
```
